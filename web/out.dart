import "dart:async" as IB;import "dart:web_audio" as YC;import "dart:web_sql" as JF;import "dart:math" as LB;import "dart:mirrors" as aG;import "dart:html" as ZB;import "dart:indexed_db" as CE;class bG{static const  cG="Chrome";static const  dG="Firefox";static const  eG="Internet Explorer";static const  fG="Safari";final  qF;final  minimumVersion;const bG(this.qF,[this.minimumVersion]);}class gG{final  name;const gG(this.name);}class TD extends CB{final  label,lD;final  index;TD(this.label,this.lD,this.index);}class hG extends cC{var dC=[VD];var k;var NB;var pD,qD;hG(this.k);initialize(){var g=l.nB(XB);NB=g.TC(ZC).LD(w);pD=NB.cx;qD=NB.cy;}VC(){if(pD==NB.cx&&qD==NB.cy){k.oF(l.MB/1000);}else{k.OB-= l.MB/100;k.tD+= l.MB/100;pD=NB.cx;qD=NB.cy;}}RB()=>k.pB&&dC.contains(k.iC);}class iG extends hB{var mC;var o;var k;var cB;var button;iG(this.o,this.k):super(DB.bB([tB]));initialize(){mC=new BB<tB>(tB,l);o.canvas..onMouseMove.listen((g)=>cB=bC.ZD(g))..onMouseDown.listen((g)=>button=g.button)..onMouseUp.listen((g)=>button=null);}UB( h){if(null!=cB){var g=mC.get(h);if(g.x<cB.x&&g.x+g.width>cB.x&&g.y<cB.y&&g.y+g.height>cB.y){g.mD=true;if(button!=null){g.YE(button);}else{g.oE();}}else{g.mD=false;if(button!=null){k.IF=true;}}}}RB()=>!k.pB;}class kG extends cC{var o;kG(this.o);VC(){o.clear(color:'#dfefd7');}NC()=>o.save();end()=>o.restore();}class jG extends hB{var dB;var fC;jG(this.fC):super(DB.bB([UD]));initialize(){dB=new BB<UD>(UD,l);}UB( g){var h=dB.get(g);fC.zE('default',h.ZE);g.QC();}}var DE={'wait1':{'check':( g)=>g.WC>60,'desc':'You have waited 1 minute! Ok, that was easy.','label':'Novice Waiter','score':15},'wait3':{'check':( g)=>g.WC>180,'desc':'You have waited 3 minutes! Keep waiting!','label':'Apprentice Waiter','score':15},'wait5':{'check':( g)=>g.WC>300,'desc':'You have waited 5 minutes! Not breaking a sweat.','label':'Expert Waiter','score':50},'wait15':{'check':( g)=>g.WC>900,'desc':'You have waited 15 minutes! Your patience is great.','label':'Master Waiter','score':150},'wait1190':{'check':( g)=>g.WC>1190,'desc':'You have waited 1190 seconds! Are you going to wait for it?','label':'TimeWaiter','score':250},'wait60':{'check':( g)=>g.WC>3600,'desc':'You have waited 1 hour! Better stop now, otherwise you\'ll miss a *ONG.','label':'GONG','score':1000},'hoverStart':{'check':( g)=>g.pE,'desc':'You only have to click it.','label':'Almost there','score':1},'wrongButton':{'check':( g)=>g.HF,'desc':'Are you sure you know what you are doing?','label':'Too many buttons','score':-3},'wrongPosition':{'check':( g)=>g.IF,'desc':'Everything alright?','label':'Drunken style','score':-3},'gameStarted':{'check':( g)=>g.pB,'desc':'Wow, you must be a bright one!','label':'Game started','score':10},'dodgeNovice':{'check':( g)=>g.RC>0,'desc':'You have dodged you first ball! Can you dodge more?','label':'Novice dodger','score':10},'dodgeApprentice':{'check':( g)=>g.RC>10,'desc':'You have dodged 10 balls in a row!','label':'Apprentice dodger','score':50},'dodgeExpert':{'check':( g)=>g.RC>100,'desc':'You have dodged 100 balls! How are you doing this?','label':'Expert dodger','score':250},'dodgeMaster':{'check':( g)=>g.RC>1000,'desc':'You have dodged 1.000 balls without getting hit! Noone can ever hit you.','label':'Master dodger','score':5000},'dodgeBeginner':{'check':( g)=>g.nC>0,'desc':'You have been hit by your first ball. Better start running now!','label':'The Last Stand','score':-5},'dodgeLazy':{'check':( g)=>g.nC>10,'desc':'You should at least try to dodge the ball.','label':'Lazy Mouse','score':-20},'dodgeRock':{'check':( g)=>g.nC>100,'desc':'You dodge like a rock! Are you even trying?','label':'The Rock','score':-100},'negative1':{'check':( g)=>g.OB<-10,'desc':'Negative score is BAD. Positive score id GOOD.','label':'Going backwards','score':-50},'negative2':{'check':( g)=>g.OB<-100,'desc':'Stop that!!.','label':'Wrong-way driver','score':-200},'pong1':{'check':( g)=>g.rC>0,'desc':'Your first pong','label':'Ponged','score':10},'pong2':{'check':( g)=>g.rC>10,'desc':'You ponged ten times in a row!','label':'10 x Ponger','score':100},'pong3':{'check':( g)=>g.rC>100,'desc':'You ponged 100 times in a row! You seem to be experienced.','label':'100 x Ponger','score':500},'lostpong1':{'check':( g)=>g.qC>0,'desc':'Oh no!! You lost you pong!! Now what?','label':'Wait what?','score':-10},'lostpong2':{'check':( g)=>g.qC>10,'desc':'That doesn\'t look good, better start stopping the pongs.','label':'Uh ooh...','score':-50},'lostpong3':{'check':( g)=>g.qC>100,'desc':'This is not dodgeball! Who do you think retrieves all the pongs.','label':'Thin like a paper','score':-100},'block1':{'check':( g)=>g.gC>0,'desc':'Finally something to destroy!','label':'One block down','score':10},'block2':{'check':( g)=>g.gC>30,'desc':'That\'s the way! Keep on destroying!','label':'The Turkey','score':50},'block3':{'check':( g)=>g.gC>100,'desc':'Keep on destroying and I\'ll keep on cheering!','label':'The Destroyer','score':500},'block4':{'check':( g)=>g.gC>1000,'desc':'You are the one and only true Master of the Universe!','label':'You are the man!','score':5000},'mover1':{'check':( g)=>g.tD>10,'desc':'You have to wait for it!','label':'Stop moving','score':-10},'mover2':{'check':( g)=>g.tD>100,'desc':'Just wait! And don\'t move!','label':'ADHD','score':-100}}; KF(){var g;var i='ld26',h='gameState';if(fF.OE){g=new fF(i,h);}else if(eF.OE){g=new eF(i,h);}else{g=new CH();}return g;}typedef  LF();typedef  MF();class lG extends eD{var zB=new List<LF>(5);var SC=new List<MF>(5);var XE=['#d34549','#d3aa9a','#6dc3cb','#d37d2c','#6daa2c','#346524','#dbd75d','#dfefd7'];var GB;var fB;var k;var ID=0;lG(this.k):super(20000,DB.AD());initialize(){zB[VD]=uD;zB[EE]=HG;zB[FE]=GG;zB[GE]=EG;zB[tC]=FG;SC[VD]=uD;SC[EE]=wD;SC[FE]=wD;SC[GE]=VG;SC[tC]=uD;GB=l.nB(IC);fB=l.nB(XB);}AC(NH){var h=GB.jC(k.SB(uB));if(!h.isEmpty){h.forEach((g){g.disable();});}ID=PB.nextInt(zB.length);k.iC=ID;var i=GB.jC(k.SB(uB));if(!i.isEmpty){i.forEach((g){g.enable();});SC[ID]();}else{zB[ID]();}}RB(){var g=k.pB&&super.RB();k.bE=(20000-MB)~/1000;return g;} uD(){} HG(){HD(LB.PI/4+PB.nextDouble()*LB.PI/2);YB(s~/2,u-100,100,20);YB(s~/2,100,s-220,20,speedup:true);YB(100,u~/2,20,u-220,speedup:true);YB(s-100,u~/2,20,u-220,speedup:true);} wD(){if(GB.jC(k.SB(WD)).isEmpty){var h=1+LB.max(0,k.OB~/250);for(int g=0;g<h;g++ ){HD(LB.PI/4+PB.nextDouble()*LB.PI/2);}}} VG(){wD();if(GB.jC(k.SB(uC)).isEmpty){dE();}} GG(){HD(LB.PI/4+PB.nextDouble()*LB.PI/2);YB(s~/2,u-100,100,20);YB(s~/2,100,100,20);YB(100,u~/2,20,100);YB(s-100,u~/2,20,100);} EG(){HD(LB.PI/4+PB.nextDouble()*LB.PI/2);YB(s~/2,u-100,100,20);YB(s~/2,100,s-220,20);YB(100,u~/2,20,u-220);YB(s-100,u~/2,20,u-220);dE();} FG(){wF();} wF(){var g=l.lB();g.AB(new w(s~/2,u~/2));g.AB(new FC(25));g.AB(new GC(fillStyle:'#d37d2c'));g.AB(new aC(100,s-100,100,u-100,1));g.jB();fB.register(g,HE);GB.add(g,k.SB(uB));} HD( h){var g=l.lB();g.AB(new w(s~/2,u-120));g.AB(new aB(10,10));g.AB(new GC(fillStyle:'#452434'));g.AB(new gB(0.25,h));g.jB();GB.add(g,k.SB(WD));GB.add(g,k.SB(uB));} YB( j, n, h, i,{ speedup: false}){var g=l.lB();if(speedup){g.AB(new IE());}g.AB(new w(j,n));g.AB(new aB(h,i));g.AB(new GC(strokeStyle:'#452434',fillStyle:'#8696a2'));g.AB(new aC(100+i~/2+h~/2,s-(100+i~/2+h~/2),100+i~/2+h~/2,u-(100+i~/2+h~/2),1,horizontal:h>i?true:false,vertical:i>h?true:false));g.jB();GB.add(g,k.SB(uC));GB.add(g,k.SB(uB));} dE(){for(int i=135;i<s-130;i+= 60){var j=XE[PB.nextInt(XE.length)];for(int h=150;h<u-250;h+= 30){var g=l.lB();g.AB(new w(i+20,h+20));g.AB(new aB(50,20));g.AB(new GC(strokeStyle:'#140c1c',fillStyle:j));g.AB(new vC());g.jB();GB.add(g,k.SB(uC));GB.add(g,k.SB(uB));}}}}class EC extends CB{final  max;var current;EC(this.max){current=max.toDouble();} get ratio=>current<=0.0?0.0:current/max;}class mG extends cC{const UE='Score: ';const TE='Highscore: ';const RE='Achievements: ';const SE='Countdown: ';var yD,hD,nE,jD;var RD,BD,kD;var o;var k;mG(this.o,this.k);initialize(){yD=o.eB(UE);hD=o.eB(RE);nE=o.eB(TE);jD=o.eB(SE);RD=u-yD.height;BD=RD-hD.height;kD=BD-jD.height;}VC(){o.fillText(UE,s-150-yD.width,RD);o.fillText(RE,s-150-hD.width,BD);o.fillText(SE,s-150-jD.width,kD);o.fillText(TE,s-150-nE.width,0);var g=k.OB.toStringAsFixed(3);var h=o.eB(g);o.fillText(g,s-h.width,RD);g=k.gD.toString();h=o.eB(g);o.fillText(g,s-h.width,BD);g=k.bE.toString();h=o.eB(g);o.fillText(g,s-h.width,kD);g=k.MD.toStringAsFixed(3);h=o.eB(g);o.fillText(g,s-h.width,0);}RB()=>k.pB;NC()=>o.save();end()=>o.restore();}class nG extends eD{const fD='highScore';var BC;var k;nG(this.BC,this.k):super(30000,DB.AD());initialize(){BC.iE(fD).then((g){if(null!=g){k.MD=g;}});}AC(NH){BC.iE(fD).then((g){if(null==g||g<k.OB){BC.save(k.OB,fD);}});}}class UD extends CB{final  ZE;UD(this.ZE);} NF(){var j=ZB.window.location.href.lastIndexOf('/web/');var h=ZB.window.location.href.substring(0,j)+'/res/sfx/';var g;try {g=new sB(h);var i=g.MG('default');i.AF=false;}catch (n){g=new pG(h);}return g;}const s=800;class tB extends CB{final  x,y,width,height;final  label;final  oE,YE;var mD=false;tB(this.x,this.y,this.width,this.height,this.label,this.oE,this.YE);}const u=600;const VD=0;const EE=4;const FE=2;const GE=3;const tC=1;const ZC='player';const HE='dodgeballplayer';const WD='pongball';class aB extends CB{var width,height;aB(this.width,this.height);}const uC='block';const uB='gamegroup';var PB=new LB.Random();class oG extends cC{var k;oG(this.k);VC(){var j=new List<String>();DE.forEach((i,h){if(h['check'](k)){var g=l.lB();g.AB(new TD(h['label'],h['desc'],k.gD));g.AB(new EC(5000));g.jB();g=l.lB();g.AB(new UD('achievement'));g.jB();k.mF(h['score']);j.add(i);}});j.forEach((i)=>DE.remove(i));}} main(){ZB.window.setImmediate((){var i=YD('#gameCanvas');i..canvas.height=u..canvas.width=s..textBaseline='top'..font='20px Verdana'..fillStyle='#140c1c';var g=NF();var h=KF();IB.Future.wait([g.kC('achievement','achievement.ogg').load(),g.kC('dodgeballhit','dodgeballhit.ogg').load(),g.kC('blockdestroyed','blockdestroyed.ogg').load(),g.kC('paddlehit','paddlehit.ogg').load(),h.open()]).then((NH){new tG(i,g,h).start();});});}class FC extends CB{var PD;FC(this.PD);}class pG implements sB{var baseURL;pG([this.baseURL='/']);var OH=new Map<String,OF>(); kC( h, i){var g=OH[h];if(g!=null){return g;}g=new OF.HH(this,h,"${baseURL}${i}");OH[h]=g;return g;} zE( h, g,[ looped=false]){OH[g].play();return null;} noSuchMethod( g){}}class w extends CB{var cx,cy;w(this.cx,this.cy);}class aC extends CB{var wE,uE,xE,vE,sD;var horizontal,vertical;aC(this.wE,this.uE,this.xE,this.vE,this.sD,{this.horizontal: true,this.vertical: true});}class qG extends cC{var o;var cB;var vD;qG(this.o);initialize(){o.canvas..onMouseMove.listen((g)=>cB=bC.ZD(g));var h=l.nB(XB);vD=h.TC(ZC).LD(w);}VC(){if(null!=cB){vD.cx=cB.x;vD.cy=cB.y;}}}class GC extends CB{var strokeStyle,fillStyle;GC({this.strokeStyle,this.fillStyle});}class gB extends CB{var MC,PH;gB(this.MC,this.PH);set angle( g)=>PH=g%dD.ZF;get angle=>PH;}class OF implements KB{final  QH;var RH;var SH;var FD=new List<ZB.AudioElement>();OF.HH(this.QH,this.RH,this.SH); load(){var g=new ZB.AudioElement();var h=new IB.Completer<KB>();g.onCanPlay.first.then((NH){h.complete(this);});g.src=SH;FD.add(g);return h.future;} play(){var h=FD.where((i)=>i.ended).iterator;var g;if(h.moveNext()){g=h.current;}else{g=FD[0].clone(false);FD.add(g);}g.play();} noSuchMethod( g){}}class vC extends CB{}class rG extends hB{var fB;rG():super(DB.bB([EC]));initialize(){fB=new BB<EC>(EC,l);}UB( g){var h=fB.get(g);if(h.current<0){g.QC();}else{h.current-= l.MB;}}}class p{final GH=2;var TH=0,MD=0;var UH=0,tD=0;var RC=0,nC=0,rC=0,qC=0,gC=0;var gD=0,bE=0;var iC=0;var pB=false,pE=false,HF=false,IF=false; get WC=>UH;p();set OB( g){TH=g;if(g>MD){MD=g;}}get OB=>TH; SB( g)=>'${g}_${iC}'; oF( g){UH+= g;OB+= g;} mF( g){gD++ ;OB+= g;}}class IE extends CB{}class sG extends hB{var NB;var HB;var gE;sG():super(DB.bB([w,aC]));initialize(){var g=l.nB(XB);NB=g.TC(ZC).LD(w);HB=new BB<w>(w,l);gE=new BB<aC>(aC,l);}UB( n){var h=HB.get(n);var g=gE.get(n);var i=0;var j=0;if(g.horizontal){var VB=mE(NB.cx,g.wE,g.uE);i=VB-h.cx;}if(g.vertical){var XC=mE(NB.cy,g.xE,g.vE);j=XC-h.cy;}var JB=LB.atan2(j,i);var t=g.sD*LB.cos(JB)*l.MB;var q=g.sD*LB.sin(JB)*l.MB;h.cx+= dD.NE(t)*LB.min(t.abs(),i.abs());h.cy+= dD.NE(q)*LB.min(q.abs(),j.abs());} mE( g, i, h){if(g>h){g=h;}else if(g<i){g=i;}return g;}}class tG{var k=new p();var l=new HC();var oD;var o;var fC;var BC;tG(this.o,this.fC,this.BC); start(){var h=new XB();var i=new IC();l.CD(h);l.CD(i);var g=l.lB();g.AB(xF());g.jB();g=l.lB();g.AB(new w(0,0));g.jB();h.register(g,ZC);l.FB(new iG(o,k));l.FB(new qG(o));l.FB(new hG(k));l.FB(new oG(k));l.FB(new rG());l.FB(new sG());l.FB(new vG());l.FB(new wG(k));l.FB(new BH(k));l.FB(new kG(o));l.FB(new yG(o));l.FB(new zG(o));l.FB(new xG(o,k));l.FB(new mG(o,k));l.FB(new uG(o,k));l.FB(new jG(fC));l.FB(new nG(BC,k));l.FB(new lG(k));l.FB(new AH(k));l.initialize();ZB.window.animationFrame.then((j){oD=j;ZB.window.animationFrame.then(hE);});} xF(){var g=()=>k.pE=true;var i=( h){if(h==0){k.pB=true;}else{k.HF=true;}};return new tB(s~/2-100,u~/2-50,250,100,'START GAME',g,i);} hE( g){l.MB=g-oD;oD=g;l.process();ZB.window.animationFrame.then(hE);}}class uG extends rB{const  xB=200;var o;var oB;var mB;var k;var nD;var ED;var fB;uG(this.o,this.k):super(DB.bB([TD,EC]));initialize(){ED=new BB<TD>(TD,l);fB=new BB<EC>(EC,l);oB=YD(xB+20,u)..textBaseline='top'..font='bold 16px Verdana'..fillStyle='#30346d'..lineWidth=3;mB=YD(xB+20,u)..textBaseline='top'..fillStyle='#140c1c'..font='14px Verdana';}AC( n){var h=new List<m>();n.forEach((g)=>h.add(g));h.sort((i,j){var t=ED.get(i);var q=ED.get(j);return t.index-q.index;});h.forEach((g)=>UB(g));}UB( j){var i=ED.get(j);var q=fB.get(j);var h=q.ratio;var n=oB.eB(i.label,xB);var t=mB.eB(i.lD,xB);var g=(t.height+n.height)+5;if(nD){nD=false;if(h<0.1){oB.translate(0,-g*((0.1-h)/0.1));mB.translate(0,-g*((0.1-h)/0.1));}}oB.translate(0,g+2);mB.translate(0,g+2);oB..globalAlpha=h..xD(2,-g,xB+16,g,10,fillStyle:'#597dcf',strokeStyle:'#d34549')..GF(i.label,10,-g,xB);mB..globalAlpha=h..GF(i.lD,10,-g+n.height,xB);}NC(){oB.save();mB.save();nD=true;}end(){oB.restore();mB.restore();o.drawImage(oB.canvas,0,0);o.drawImage(mB.canvas,0,0);oB.clear();mB.clear();}RB()=>true;}class vG extends hB{var HB;var DC;vG():super(DB.bB([w,gB]));initialize(){DC=new BB<gB>(gB,l);HB=new BB<w>(w,l);}UB( h){var g=DC.get(h);var i=HB.get(h);i.cx+= g.MC*LB.cos(g.angle)*l.MB;i.cy+= g.MC*LB.sin(-g.angle)*l.MB;}}class wG extends hB{var GB;var HB;var DC;var kB;var KD;var dB;var k;wG(this.k):super(DB.bB([w,aB,gB]).fE([aC]));initialize(){GB=l.nB(IC);DC=new BB<gB>(gB,l);HB=new BB<w>(w,l);kB=new BB<aB>(aB,l);KD=new BB<vC>(vC,l);dB=new BB<IE>(IE,l);}UB( q){var g=HB.get(q);var VB=kB.get(q);var ZG=GB.jC(k.SB(uC));ZG.forEach((j){var i=HB.get(j);var n=kB.get(j);var JB=g.cx-i.cx;var t=g.cy-i.cy;if(rE(JB,t,VB,n)){k.OB+= 1;var h=DC.get(q);var XC=DG(g,VB,i,n,h);do{g.cx-= h.MC*LB.cos(h.angle)*l.MB;g.cy-= h.MC*LB.sin(-h.angle)*l.MB;JB=g.cx-i.cx;t=g.cy-i.cy;}while(rE(JB,t,VB,n));h.angle=XC;if(null!=KD.lE(j)){j.QC();XD(l,'blockdestroyed');k.gC++ ;}else{if(n.width==100||n.height==100){k.rC++ ;k.qC=0;}XD(l,'paddlehit');}if(null!=dB.lE(j)){h.MC+= 0.01;}}});if(g.cx<-200||g.cy<-200||g.cx>s+200||g.cy>u+200){k.OB-= 10;q.QC();k.rC=0;k.qC++ ;}} DG( t, JB, n, VB, i){var g;var q=kE(t,JB);var j=kE(n,VB);var h=q.intersection(j);if(KG(h)){if((h.width-h.height).abs()<6){g=LB.PI-i.angle-LB.PI/4+PB.nextDouble()*LB.PI/2;}else{g=LB.PI-i.angle;}}else{if((h.width-h.height).abs()<6){g=-i.angle-LB.PI/4+PB.nextDouble()*LB.PI/2;}else{g=-i.angle;}}return g;} kE( h, g){return new ZB.Rect(h.cx-g.width/2,h.cy-g.height/2,g.width,g.height);} KG( g){if(g.width<g.height){return true;}return false;} rE( i, j, g, h){if(i.abs()<=g.width/2+h.width/2&&j.abs()<=g.height/2+h.height/2){return true;}return false;}}class xG extends hB{var mC;var o;var k;xG(this.o,this.k):super(DB.bB([tB]));initialize(){mC=new BB<tB>(tB,l);}UB( q){var g=mC.get(q);var n=o.eB(g.label);var h,j,i;if(g.mD){h='#d37d2c';j='#6daa2c';i='#dfefd7';}else{h='#d34549';j='#346524';i='#dbd75d';}o..xD(g.x,g.y,g.width,g.height,20,strokeStyle:j,fillStyle:h)..fillStyle=i..fillText(g.label,g.x+g.width/2-n.width/2,g.y+g.height/2-n.height/2);}NC(){o..save()..clear(color:'#dfefd7')..lineWidth=5..xD(20,20,s-40,u-40,20,strokeStyle:'#346524',fillStyle:'#30346d');}end(){o.restore();}RB()=>!k.pB;}class yG extends hB{var BF;var HB;var dB;var o;yG(this.o):super(DB.bB([aB,w,GC]));initialize(){BF=new BB<aB>(aB,l);HB=new BB<w>(w,l);dB=new BB<GC>(GC,l);}UB( h){var j=HB.get(h);var g=BF.get(h);var i=dB.get(h);o..strokeStyle=i.strokeStyle..fillStyle=i.fillStyle..beginPath()..rect(j.cx-g.width/2,j.cy-g.height/2,g.width,g.height)..closePath()..fill()..stroke();}NC()=>o.save();end()=>o.restore();}class zG extends hB{var kB;var HB;var dB;var o;zG(this.o):super(DB.bB([FC,w,GC]));initialize(){kB=new BB<FC>(FC,l);HB=new BB<w>(w,l);dB=new BB<GC>(GC,l);}UB( g){var i=HB.get(g);var j=kB.get(g);var h=dB.get(g);o.tF(i.cx,i.cy,j.PD,strokeStyle:h.strokeStyle,fillStyle:h.fillStyle);}}class AH extends eD{var dC=[tC];var NB;var k;var GB;AH(this.k):super(900,DB.AD());initialize(){GB=l.nB(IC);var g=l.nB(XB);NB=g.TC(ZC).LD(w);}AC(NH){var h=1+LB.max(0,k.OB~/250);for(int g=0;g<h;g++ ){WG();}} WG(){var i,h;if(PB.nextBool()){i=PB.nextInt(s);if(PB.nextBool()){h=-100;}else{h=u+100;}}else if(PB.nextBool()){i=-100;h=PB.nextInt(u);}else{i=s+100;h=PB.nextInt(u);}var q=LB.max(LB.min(NB.cx,s-100),100);var j=LB.max(LB.min(NB.cy,u-100),100);var n=LB.atan2(j-h,q-i);var g=l.lB();g.AB(new w(i,h));g.AB(new gB(0.5,-n));g.AB(new FC(10));g.AB(new GC(fillStyle:'#d34549'));g.jB();GB.add(g,k.SB(WD));GB.add(g,k.SB(uB));}RB()=>k.pB&&dC.contains(k.iC)&&super.RB();}class BH extends hB{var dC=[tC];var fB;var HB;var DC;var kB;var KD;var k;BH(this.k):super(DB.bB([w,FC,gB]).fE([aC]));initialize(){fB=l.nB(XB);DC=new BB<gB>(gB,l);HB=new BB<w>(w,l);kB=new BB<FC>(FC,l);KD=new BB<vC>(vC,l);}UB( h){var g=HB.get(h);var q=kB.get(h);var i=fB.TC(HE);var j=HB.get(i);var n=kB.get(i);if(VF.bF(g.cx,g.cy,q.PD,j.cx,j.cy,n.PD)){k.OB-= 10;h.QC();XD(l,'dodgeballhit');k.RC=0;k.nC++ ;}else if(g.cx<-200||g.cy<-200||g.cx>s+200||g.cy>u+200){k.OB+= 1;h.QC();k.RC++ ;k.nC=0;}}RB()=>k.pB&&dC.contains(k.iC);} XD( h, i){var g=h.lB();g.AB(new UD(i));g.jB();}class bC{static final  QF=ZB.window.navigator.userAgent.contains(r'Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone');static  SF( g){var h=new ZB.CanvasElement(width:g.width,height:g.height);h.context2D.drawImage(g,0,0);return h;}static  ZD( g){var t=0,n=0,JB=0,q=0,j=0,i=0;var h=g.currentTarget;do{t+= h.offset.left;n+= h.offset.top;}while(null!=(h=h.offsetParent));if(null!=g.page.x||null!=g.page.y){j=g.page.x;i=g.page.y;}else if(g is ZB.MouseEvent){if(null!=g.client.x||null!=g.client.y){j=g.client.x+ZB.document.body.scrollLeft+ZB.document.documentElement.scrollLeft;i=g.client.y+ZB.document.body.scrollTop+ZB.document.documentElement.scrollTop;}}JB=j-t;q=i-n;return new ZB.Point(JB,q);}}class PF{final  cE;PF.IH(this.cE); get VH=>cE.canvas; WH( g)=>bC.ZD(g); get XH=>bC.QF; get onMouseMove{var g;if(XH){g=VH.onTouchMove;}else{g=VH.onMouseMove;}return g.map((h)=>WH(h));} get onMouseDown{var i=new IB.StreamController<JE>();var h;if(XH){h=VH.onTouchStart;}else{h=VH.onMouseDown;}h.listen((g){g.preventDefault();i.add(new JE(WH(g),g.button));});return i.stream;} get onMouseUp{var g;if(XH){g=VH.onTouchEnd;}else{g=VH.onMouseUp;}return g.map((h)=>new JE(WH(h),h.button));}} YD([var selector, height]){var g;if(null==selector||selector is int){var h=(selector!=null?selector:ZB.window.innerWidth);height=(height!=null?height:ZB.window.innerHeight);g=new ZB.CanvasElement(width:h,height:height);}else if(selector is String){g=ZB.query(selector);}else if(selector is ZB.ImageElement){g=bC.SF(selector);}else if(selector is QB){return selector;}else{g=selector;}return new QB(g);}class QB implements ZB.CanvasRenderingContext2D{static final  RF=new RegExp((r'\s+'));var VH;var YH;var ZH; get canvas=>VH;QB(this.VH){YH=VH.context2D;ZH=new PF.IH(this);} noSuchMethod( g)=>aG.reflect(YH).delegate(g); DF({ strokeStyle, fillStyle}){if(null!=strokeStyle){var g=YH.strokeStyle;YH..strokeStyle=strokeStyle..stroke()..strokeStyle=g;}if(null!=fillStyle){var g=YH.fillStyle;YH..fillStyle=fillStyle..fill()..fillStyle=g;}} tF( i, g, h,{ strokeStyle, fillStyle}){YH.beginPath();YH.arc(i,g,h,0,LB.PI*2,true);YH.closePath();DF(strokeStyle:strokeStyle,fillStyle:fillStyle);} clear({ color}){if(null!=color){YH.fillStyle=color;YH.fillRect(0,0,VH.width,VH.height);}else{YH.clearRect(0,0,VH.width,VH.height);}} xD( h, g, j, n, i,{ strokeStyle, fillStyle}){YH..beginPath()..moveTo(h+i,g)..lineTo(h+j-i,g)..quadraticCurveTo(h+j,g,h+j,g+i)..lineTo(h+j,g+n-i)..quadraticCurveTo(h+j,g+n,h+j-i,g+n)..lineTo(h+i,g+n)..quadraticCurveTo(h,g+n,h,g+n-i)..lineTo(h,g+i)..quadraticCurveTo(h,g,h+i,g)..closePath();DF(strokeStyle:strokeStyle,fillStyle:fillStyle);} GF( VB, h, q, t,{ nlCallback}){var XC=new RegExp(r"(\d+)");var JB=int.parse(XC.firstMatch(font).group(0))*2;var i=jE(VB,t);for(var g=0;g<i.length;g++ ){var j=(q+g*JB*0.6).toInt();if(null!=nlCallback){nlCallback(h,j);}var n=i[g];YH.fillText(n,h,j);}} eB( g,[ maxWidth]){var i=new RegExp(r"(\d+)");var h=int.parse(i.firstMatch(font).group(0))*2;var j=jE(g,maxWidth);if(null==maxWidth){maxWidth=YH.measureText(g).width;}return new ZB.Rect(0,0,maxWidth,(j.length*h*0.6).toInt());} jE( t,[ maxWidth]){var q=t.split(RF);var i=0;var XC=0;var g=new List<String>.from([""]);var VB=YH.measureText(" ").width;if(null!=maxWidth){maxWidth+= VB;var j=0;for(var h=0;h<q.length;h++ ){var JB="${q[h]} ";var n=YH.measureText(JB).width;if(i+n>maxWidth){g.add("");j++ ;i=0;}g[j]="${g[j]}${JB}";i+= n;}}else{g=[t];}return g;}}class JE{final  position;final  button;JE(this.position,this.button);}typedef  TF( x, y);abstract class KE{ DD( g); iD( g); yB( g); enabled( g); disabled( g);}class bD extends qB{var aH;var cH;var iH;var jH=0;var kH=0;var lH=0;var fH=0;var rH;bD():aH=new v<m>(),cH=new v<m>(),iH=new v<bool>(),rH=new cF(); initialize(){} OI(){var g=cH.removeLast();if(null==g){g=new m.KH(dH,rH.sF());}lH++ ;return g;} DD( g){jH++ ;kH++ ;aH[g.id]=g;} enabled( g){iH[g.id]=false;} disabled( g){iH[g.id]=true;} yB( g){aH[g.id]=null;iH[g.id]=false;cH.add(g);jH-- ;fH++ ;} cI( g)=>aH[g];}class VF{static  bF( JB, j, n, q, VB, t){var g=q-JB;var i=VB-j;var h=n+t;return (g*g+i*i)<(h*h);}}class wC{static var ME=new Map<Type,vB>();static  yC( h){var g=ME[h];if(g==null){g=new vB();ME[h]=g;}return g;}static  aF( g)=>yC(g).WE;}class vB{static var cD=1;static var WF=0;var eH=0;var gH=0;vB(){eH=cD;cD=cD<<1;gH=WF++ ;} get WE=>eH; get id=>gH;}class aD extends qB{var bH;var fH;aD():bH=new v<v<CB>>(),fH=new v<m>(); initialize(){} vH( g){zH(g,(h,i){h[g.id].yH();h[g.id]=null;});g.GI=0;} LI( i, j, n){var h=j.id;bH.SI(h);var g=bH[h];if(g==null){g=new v<CB>();bH[h]=g;}g[i.id]=n;i.XI(j.WE);} CG( i){var h=i.id;bH.SI(h);var g=bH[h];if(g==null){g=new v<CB>();bH[h]=g;}return g;} dI( h, j){var i=j.id;var g=bH[i];if(g!=null&&g.sE(h.id)){return g[h.id];}return null;} zH( i, j( components, index)){var g=i.GI;var h=0;while (g>0){if((g&1)==1){j(bH[h],h);}h++ ;g=g>>1;}} yB( g)=>fH.add(g); uF(){fH.forEach((g)=>vH(g));fH.clear();}}class UF{static var LE=0;static var xC;static  XF( h){if(null==xC){xC=new Map<Type,int>();}var g=xC[h];if(g==null){g=1<<LE;LE++ ;xC[h]=g;}return g;}}abstract class qB implements KE{var dH; initialize(); DD( g){} iD( g){} yB( g){} disabled( g){} enabled( g){}}class wB<WB>{var hH;wB.JH(this.hH); operator[]( g)=>hH[g]; get size=>hH.size; get isEmpty=>hH.isEmpty; contains( g)=>hH.contains(g); forEach( g( element))=>hH.forEach(g);}class dD{static const  YF=LB.PI;static const  ZF=2.0*YF;static  NE( g)=>(g<0)?-1:(g>0)?1:0;}class m{final  id;var EI=0;var GI=0;var xC=0;var dH;var xH;var CI;m.KH(this.dH,this.id){xH=dH.zF;CI=dH.aE;} XI( g){GI|= g;} ZI( g){xC|= g;} aI( g){xC&= ~g;} toString()=>"Entity[${id}]"; AB( g){CI.LI(this,wC.yC(g.runtimeType),g);} BG( g){return CI.dI(this,g);} LD( g){return BG(wC.yC(g));} jB()=>dH.nF(this); QC()=>dH.yF(this); disable()=>dH.disable(this); enable()=>dH.enable(this);}abstract class hB extends rB{hB( g):super(g); UB( g); AC( h)=>h.forEach((g)=>UB(g)); RB()=>true;}abstract class eD extends rB{var oH=0;var sH=0;final  uH; get MB=>sH;eD(this.uH, g):super(g); RB(){oH+= l.MB;sH+= l.MB;if(oH>=uH){oH-= uH;return true;}return false;} end(){sH=0;}}class BB<zC extends CB>{var pH;var tH;BB( h, g){this.pH=wC.yC(h);tH=g.aE.CG(this.pH);}zC get( g)=>tH[g.id] as zC; lE( g){if(tH.sE(g.id)){return tH[g.id] as zC;}return null;}}class v<WB>{var mH;var nH=0;var qH;v({ capacity: 16}):mH=new List(capacity){qH=new wB.JH(this);} operator[]( g)=>mH[g]; get size=>nH; get readOnly=>qH; get isEmpty=>nH==0; forEach( h( element)){for(int g=0;g<nH;g++ ){h(mH[g]);}} removeLast(){if(nH>0){var g=mH[ --nH];mH[nH]=null;return g;}return null;} remove( i){for(int g=0;g<nH;g++ ){var h=mH[g];if(i==h){mH[g]=mH[ --nH];mH[nH]=null;return true;}}return false;} contains( h){for(int g=0;nH>g;g++ ){if(h==mH[g]){return true;}}return false;} get rF=>mH.length; add( g){if(nH==mH.length){kI();}mH[nH++ ]=g;} operator[]=( g, h){if(g>=mH.length){lI(g*2);}if(nH<=g){nH=g+1;}mH[g]=h;} kI(){var g=((mH.length*3)/2+1).toInt();lI(g);} lI( h){var g=mH;mH=new List<WB>(h);mH.setRange(0,g.length,g);} SI( g){if(g>=mH.length){lI(g*2);}} clear(){for(int g=0;g<nH;g++ ){mH[g]=null;}nH=0;} addAll( h){for(int g=0;h.size>g;g++ ){add(h[g]);}} sE( g)=>g<rF; toString()=>"[${mH.join(',')}]";}abstract class CB{ yH(){}}class XB extends qB{final  wH;final  AI;XB():wH=new Map<String,m>(),AI=new Map<m,String>(); register( g, h){wH[h]=g;AI[g]=h;} unregister( g){AI.remove(wH.remove(g));} TC( g)=>wH[g]; yB( h){var g=AI.remove(h);if(g!=null){wH.remove(g);}} initialize(){}}abstract class cC extends rB{cC():super(DB.AD()); AC( g)=>VC(); VC(); RB()=>true;}class HC{final  xH=new bD();final  CI=new aD();final  kH=new v<m>();final  JI=new v<m>();final  fH=new v<m>();final  RI=new v<m>();final  TI=new v<m>();final  UI=new Map<Type,rB>();final  VI=new List<rB>();final  WI=new Map<Type,qB>();final  YI=new v<qB>();var MB;HC(){CD(xH);CD(CI);} initialize(){YI.forEach((h)=>h.initialize());VI.forEach((g)=>g.initialize());} get zF=>xH; get aE=>CI; CD( g){WI[g.runtimeType]=g;YI.add(g);g.dH=this;} nB( g){return WI[g];} lB(){return xH.OI();} TC( g){return xH.cI(g);} FB( g,{ passive: false}){g.l=this;g.QI=passive;UI[g.runtimeType]=g;VI.add(g);return g;} eI( i, h(EntityObserver,Entity)){i.forEach((g){YI.forEach((j)=>h(j,g));VI.forEach((n)=>h(n,g));});i.clear();} process(){SG();VI.forEach((g){if(!g.OG){g.process();}});} SG(){eI(kH,(h,g)=>h.DD(g));eI(JI,(h,g)=>h.iD(g));eI(TI,(h,g)=>h.disabled(g));eI(RI,(h,g)=>h.enabled(g));eI(fH,(h,g)=>h.yB(g));CI.uF();} nF( g)=>kH.add(g); yF( g){if(!fH.contains(g)){fH.add(g);}} enable( g)=>RI.add(g); disable( g)=>TI.add(g);}class IC extends qB{final  BI;final  DI;IC():BI=new Map<String,v<m>>(),DI=new Map<m,v<String>>(); initialize(){} add( i, j){var h=BI[j];if(h==null){h=new v<m>();BI[j]=h;}h.add(i);var g=DI[i];if(g==null){g=new v<String>();DI[i]=g;}g.add(j);} TG( h){var g=DI[h];if(g!=null){g.forEach((j){var i=BI[j];if(i!=null){i.remove(h);}});g.clear();}} jC( h){var g=BI[h];if(g==null){g=new v<m>();BI[h]=g;}return g.readOnly;} yB( g)=>TG(g);}abstract class rB implements KE{var FI=0;var l;var HI;var II;var KI;var MI;var NI;var QI;rB( g):HI=new v<m>(),II=g.VE,KI=g.AG,MI=g.NG{NI=II==0&&MI==0;FI=UF.XF(runtimeType);}get OG=>QI; NC(){} process(){if(RB()){NC();AC(HI.readOnly);end();}} end(){} AC( g); RB(); initialize(){} IG( g){} UG( g){} eI( g){if(NI){return;}var i=fI(g);var h=(II&g.GI)==II;if(MI>0&&h){h=(MI&g.GI)>0;}if(KI>0&&h){h=(KI&g.GI)==0;}if(h&&!i){iI(g);}else if(!h&&i){jI(g);}} fI( g)=>(FI&g.xC)==FI; iI( g){HI.add(g);g.ZI(FI);IG(g);} jI( g){HI.remove(g);g.aI(FI);UG(g);} DD( g)=>eI(g); iD( g)=>eI(g); enabled( g)=>eI(g); yB( g){if(fI(g)){jI(g);}} disabled( g){if(fI(g)){jI(g);}}}class DB{var II=0;var KI=0;var MI=0; pF( g){II=bI(II,g);return this;} fE( g){KI=bI(KI,g);return this;}static  bB( h){var g=new DB();g.pF(h);return g;}static  AD()=>new DB(); get VE=>II; get AG=>KI; get NG=>MI; bI( g, h){if(null!=h){h.forEach((i){g=g|wC.aF(i);});}return g;}}class cF{var gI;var hI=0;cF():gI=new v<int>(); sF(){if(gI.size>0){return gI.removeLast();}return hI++ ;}}abstract class dF<JC> extends KC<JC>{var sC; open(){sC=mI();nI=true;return new IB.Future.value(true);} mI(); pI(){return new IB.Stream.fromIterable(sC.keys);} qI( h, g){sC[g]=h;return new IB.Future.value(g);} rI( g){return new IB.Future.value(sC[g]);} tI(){return new IB.Stream.fromIterable(sC.values);}}class eF<JC> extends KC<JC>{static final  gF="1";static const  hF=5*1024*1024;var PC;var TB;var estimatedSize;var oI;eF(this.PC,this.TB,{this.estimatedSize: hF});static  get OE=>JF.SqlDatabase.supported; open(){if(!OE){return new IB.Future.error(new UnsupportedError('WebSQL is not supported on this platform'));}var g=new IB.Completer();oI=ZB.window.openDatabase(PC,gF,PC,estimatedSize);sI(g);return g.future;} sI( h){var i='CREATE TABLE IF NOT EXISTS ${TB} (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT)';oI.transaction((g){g.executeSql(i,[] ,(g,n){nI=true;h.complete(true);});},(j)=>h.completeError(j));} pI(){var n='SELECT id FROM ${TB}';var g=new IB.StreamController();oI.transaction((j){j.executeSql(n,[] ,(j,i){for(var h=0;h<i.rows.length; ++h){var q=i.rows.item(h);g.add(q['id']);}});},(t)=>g.addError(t),()=>g.close());return g.stream;} qI( j, h){var g=new IB.Completer();var n='INSERT OR REPLACE INTO ${TB} (id, value) VALUES (?, ?)';oI.transaction((i){i.executeSql(n,[h,j],(i,t){g.complete(h);});},(q)=>g.completeError(q));return g.future;} rI( n){var g=new IB.Completer();var j='SELECT value FROM ${TB} WHERE id = ?';oI.readTransaction((i){i.executeSql(j,[n],(i,h){if(h.rows.isEmpty){g.complete(null);}else{var q=h.rows.item(0);g.complete(q['value']);}});},(t)=>g.completeError(t));return g.future;} tI(){var n='SELECT id,value FROM ${TB}';var g=new IB.StreamController<JC>();oI.transaction((j){j.executeSql(n,[] ,(j,i){for(var h=0;h<i.rows.length; ++h){var q=i.rows.item(h);g.add(q['value']);}});},(t)=>g.addError(t),()=>g.close());return g.stream;}}class fF<JC> extends KC<JC>{var PC;var version;var oI;var TB;fF(this.PC,this.TB,{this.version: 1}){if(version==null){throw new ArgumentError("version must not be null");}}static  get OE=>CE.IdbFactory.supported; open(){if(!OE){return new IB.Future.error(new UnsupportedError('IndexedDB is not supported on this platform'));}return ZB.window.indexedDB.open(PC,version:version,onUpgradeNeeded:(g){oI=g.target.result;if(!oI.objectStoreNames.contains(TB)){oI.createObjectStore(TB);}}).then((h){oI=h;nI=true;return true;});} qI( g, i){return uI(( h){return h.put(g,i);});} rI( h){return uI(( g)=>g.getObject(h),'readonly');} uI( h( store),[ txnMode='readwrite']){var n=new IB.Completer();var g=oI.transaction(TB,txnMode);var i=g.objectStore(TB);var j=h(i);return g.completed.then((wI)=>j);} xI( h( cursor)){var g=new IB.StreamController<JC>();var j=oI.transaction(TB,'readonly');var i=j.objectStore(TB);i.openCursor(autoAdvance:true).listen((n)=>g.add(h(n)),onDone:()=>g.close(),onError:(q)=>g.addError(q));return g.stream;} tI(){return xI(( g)=>g.value);} pI(){return xI(( g)=>g.key);}}class CH<JC> extends dF<JC>{ mI(){return ZB.window.localStorage;}}abstract class KC<JC>{var nI=false; get LG=>nI;vI(){if(!LG)throw new StateError('${runtimeType} is not open');} open(); keys(){vI();return pI();} pI(); save( h, g){vI();if(g==null){throw new ArgumentError("key must not be null");}return qI(h,g);} qI( g, h); iE( g){vI();return rI(g);} rI( g); VE(){vI();return tI();} tI();}const DH=const EH();class EH{const EH();}class iF{final  yI;var zI;var AJ;var BJ;iF.LH(this.yI, g){zI=new LC.LH(yI,'music',g);zI.AF=false;} SJ(){if(AJ!=null){AJ.stop();AJ=null;}} get pause=>AJ==null?false:AJ.pause; set pause( g){if(AJ!=null){AJ.pause=g;}} play(){SJ();AJ=new iB.LH(zI,BJ,true);AJ.play();} stop(){SJ();}}class PE{var BE=0;var eC=0.0;var CC=0.0;var EF=0.0;var hC=0.0;var zD=0.3;var OD=0.0;var SD=0.0;var JD=0.0;var FF=0.0;var AE=0.0;var OC=0.0;var GD=0.0;var CF=0.0;var eE=0.0;var QD=0.0;var oC=0.0;var pC=0.0;var UC=0.0;var tE=0.0;var rD=0.0;var ND=0.0;var qE=0.0;var lC=0.0;PE.MH( j){var g=j.split(",");this.BE=jF(g[0]);this.eC=EB(g[1]);this.CC=EB(g[2]);this.EF=EB(g[3]);this.hC=EB(g[4]);this.zD=EB(g[5]);this.OD=EB(g[6]);this.SD=EB(g[7]);this.JD=EB(g[8]);this.FF=EB(g[9]);this.AE=EB(g[10]);this.OC=EB(g[11]);this.GD=EB(g[12]);this.CF=EB(g[13]);this.eE=EB(g[14]);this.QD=EB(g[15]);this.oC=EB(g[16]);this.pC=EB(g[17]);this.UC=EB(g[18]);this.tE=EB(g[19]);this.rD=EB(g[20]);this.ND=EB(g[21]);this.qE=EB(g[22]);this.lC=EB(g[23]);if(this.CC<.01){this.CC=.01;}var i=this.eC+this.CC+this.hC;if(i<.18){var h=.18/i;this.eC*= h;this.CC*= h;this.hC*= h;}}static  jF( g){if(g==null||g.length==0){return 0;}return int.parse(g,radix:10);}static  EB( g){if(g==null||g.length==0){return 0.0;}return double.parse(g);}}class KB{static const QE="sfxr:";final  yI;var CJ;var DJ; get url=>DJ;var EJ;var FJ=false;var GJ='';var IJ=false;var LJ=false;KB.LH(this.yI,this.CJ,this.DJ); XJ(){IJ=false;EJ=null;} vF(){FJ=false;GJ='OK';} nJ( g){FJ=true;GJ=g;} oJ( g, h){if(g==null){nJ('Error decoding buffer.');h.complete(this);return;}vF();EJ=g;IJ=true;h.complete(this);} pJ( i, h){var j=i.response;yI.OJ.decodeAudioData(j,(g)=>oJ(g,h),(g)=>oJ(g,h));} qJ( h, g){nJ('Error fetching data');g.complete(this);} load(){if(url==null){nJ('No URL set.');return new AL(this);}XJ();if(url.startsWith(QE)){return new IB.Future<KB>.delayed(new Duration(milliseconds:1),(){EJ=kF.lF(yI.OJ,url.substring(QE.length));IJ=true;return this;});}var g=new ZB.HttpRequest();var h=new IB.Completer<KB>();if(LJ){g.open('GET',url);}else{g.open('GET','${yI.baseURL}/${url}');}g.responseType='arraybuffer';g.onLoad.listen((i)=>pJ(g,h));g.onError.listen((i)=>qJ(g,h));g.onAbort.listen((i)=>qJ(g,h));g.send();return h.future;} get length{if(EJ==null){return 0;}return EJ.duration;}}class iB{final  zI;final  BJ;final  HJ;var JJ;var KJ;var MJ;var NJ;var PJ=1.0; get isScheduled=>JJ==null?false:JJ.playbackState==YC.AudioBufferSourceNode.SCHEDULED_STATE; get JG=>JJ==null?false:JJ.playbackState==YC.AudioBufferSourceNode.FINISHED_STATE;iB.LH(this.zI,this.BJ,this.HJ){lJ();} mJ(){if(JJ!=null){print('${JJ.playbackState}');}} lJ(){JJ=zI.yI.OJ.createBufferSource();if(BJ!=null&&BJ.EJ!=null){JJ.buffer=BJ.EJ;JJ.loopStart=0.0;JJ.loopEnd=BJ.EJ.duration;}JJ.gain.value=PJ;JJ.loop=HJ;JJ.connect(zI.WJ,0,0);} SJ(){if(JJ!=null){JJ.stop(0.0);}JJ=null;} get pause=>KJ!=null; set pause( g){if(g){if(KJ!=null){return;}rJ();}else{if(KJ==null){return;}sJ();}} tJ(){assert(MJ!=null);var g=zI.yI.OJ.currentTime;var h=g-MJ;if(g<NJ){return g-NJ;}if(HJ){return h%JJ.buffer.duration;}return h;} rJ(){if(MJ==null){return;}print('Sound.pause');mJ();if(JJ!=null){KJ=tJ();SJ();print('paused at ${KJ}');}} sJ(){if(KJ==null){return;}print('Sound.resume');mJ();lJ();if(KJ<0.0){KJ=-KJ;print('Scheduling to play sound in ${KJ}.');NJ=zI.yI.OJ.currentTime+KJ;JJ.start(NJ,0.0,JJ.buffer.duration);MJ=zI.yI.OJ.currentTime;}else{print('Starting to play at offset ${KJ}');NJ=zI.yI.OJ.currentTime;JJ.start(NJ,KJ,JJ.buffer.duration-KJ);MJ=zI.yI.OJ.currentTime-KJ;}KJ=null;} play([ when=0.0]){SJ();lJ();NJ=zI.yI.OJ.currentTime+when;JJ.start(NJ);MJ=zI.yI.OJ.currentTime;} stop(){SJ();MJ=null;NJ=null;KJ=null;} get volume=>PJ; set volume( g){if(JJ!=null){JJ.gain.value=g;}PJ=g;}}class sB{var OJ;var QJ;var RJ;var TJ;var VJ;var YJ;var baseURL;var cJ=new Map<String,KB>();var gJ=new Map<String,LC>();var kJ;sB([this.baseURL='']){OJ=new YC.AudioContext();QJ=OJ.destination;RJ=OJ.listener;TJ=OJ.createGain();VJ=OJ.createGain();YJ=OJ.createGain();TJ.connect(QJ,0,0);VJ.connect(TJ,0,0);YJ.connect(TJ,0,0);kJ=new iF.LH(this,VJ);} get lC=>TJ.gain.value; set lC( g){yE=false;TJ.gain.value=g;}var bJ; set yE( g){if(g){if(bJ!=null){return;}bJ=TJ.gain.value;TJ.gain.value=0;}else{if(bJ==null){return;}TJ.gain.value=bJ;bJ=null;}}var vJ=false;var wJ=false; kC( h, i){var g=cJ[h];if(g!=null){return g;}g=new KB.LH(this,h,i);cJ[h]=g;return g;} MG( h){var g=gJ[h];if(g!=null){return g;}g=new LC.LH(this,h,YJ);gJ[h]=g;return g;} zE( g, h,[ looped=false]){return PG(0.0,g,h,looped);} PG( j, i, n,[ looped=false]){var g=gJ[i];if(g==null){print('Could not find source ${i}');return null;}var h=cJ[n];if(h==null){print('Could not find clip ${n}');return null;}if(looped){return g.QG(j,h);}else{return g.RG(j,h);}}}class LC{var yI;var CJ;var UJ;var WJ;var ZJ;var aJ;var bJ;var dJ=false;var eJ=0.0;var fJ=0.0;var hJ=0.0;var iJ=true; jJ(){ZJ.disconnect(0);WJ.disconnect(0);if(iJ){WJ.connect(ZJ,0,0);ZJ.connect(UJ,0,0);}else{WJ.connect(UJ,0,0);}}LC.LH(this.yI,this.CJ,this.UJ){WJ=yI.OJ.createGain();ZJ=yI.OJ.createPanner();ZJ.coneOuterGain=1.0;jJ();aJ=new List<iB>();} set AF( g){iJ=g;jJ();} get volume=>WJ.gain.value; set volume( g){WJ.gain.value=g;} set yE( g){if(g){if(bJ!=null){return;}bJ=volume;volume=0.0;}else{if(bJ==null){return;}volume=bJ;bJ=null;}} RG( i, h){var g=new iB.LH(this,h,false);aJ.add(g);g.play(i);g.pause=pause;return g;} QG( i, h){var g=new iB.LH(this,h,true);aJ.add(g);g.play(i);g.pause=pause;return g;} uJ(){for(int g=aJ.length-1;g>=0;g-- ){var h=aJ[g];if(h.JG){var i=aJ.length-1;aJ[g]=aJ[i];aJ.removeLast();print('removing sound.');h.stop();}}} get pause=>dJ; set pause( g){if(g){if(dJ==true){return;}rJ();dJ=true;}else{if(dJ==false){return;}sJ();dJ=false;}} rJ(){uJ();aJ.forEach((g){g.pause=true;});} sJ(){uJ();aJ.forEach((g){g.pause=false;});} stop(){aJ.forEach((g){g.stop();});uJ();} get x=>eJ; get y=>fJ;}class kF{final  xJ;var yJ,zJ,AK,BK,CK,DK,EK,FK,GK,HK;var IK,JK;kF( this.xJ); reset(){var g=this.xJ;BK=100/(g.zD*g.zD+.001);CK=100/(g.OD*g.OD+.001);DK=1-g.SD*g.SD*g.SD*.01;EK=-g.JD*g.JD*g.JD*.000001;if(g.BE==0){GK=.5-g.CF/2;HK=-g.eE*.00005;}FK=g.OC>0?1-g.OC*g.OC*.9:1+g.OC*g.OC*10;IK=0;JK=(g.GD==1?0:(1-g.GD)*(1-g.GD)*20000+32).toInt();} YG(){this.reset();var g=this.xJ;yJ=g.eC*g.eC*100000;zJ=g.CC*g.CC*100000;AK=g.hC*g.hC*100000+10;return (yJ+zJ+AK).toInt();} XG( q, t){var g=this.xJ;var KK=g.UC!=1||g.ND!=0,LK=g.ND*g.ND*.1,MK=1+g.qE*.0003,NK=g.UC*g.UC*g.UC*.1,OK=1+g.tE*.0001,PK=g.UC!=1,QK=g.lC*g.lC,RK=g.OD,SK=g.oC!=0||g.pC!=0,TK=g.pC*g.pC*g.pC*.2,UK=g.oC*g.oC*(g.oC<0?-1020:1020),VK=(g.QD!=0)?(((1-g.QD)*(1-g.QD)*20000).toInt())+32:0,WK=g.EF,XK=g.FF/2,YK=g.AE*g.AE*.01,ZK=g.BE;var aK=yJ,bK=1/yJ,cK=1/zJ,dK=1/AK;var eK=5/(1+g.rD*g.rD*20)*(.01+NK);if(eK>.8){eK=.8;}eK=1-eK;var fK=false;var gK=0.0,hK=0.0,iK=0.0,jK=0.0,kK=0.0,lK=0.0,mK=0.0,nK=0.0,oK=0.0,pK=0.0,qK=0.0;var rK=0,sK=0,tK=0,uK=0,vK=0,wK=0;var n=new LB.Random();var xK=new List<double>(1024),yK=new List<double>(32);for(var h=xK.length-1;h>-1;h-- ){xK[h]=0.0;}for(var h=yK.length-1;h>-1;h-- ){yK[h]=n.nextDouble()*2-1;}for(var h=0;h<t;h++ ){if(fK){return true;}if(VK!=0){if( ++wK>=VK){wK=0;this.reset();}}if(JK!=0){if( ++IK>=JK){JK=0;BK*= FK;}}DK+= EK;BK*= DK;if(BK>CK){BK=CK;if(RK>0){fK=true;}}pK=BK;if(XK>0){qK+= YK;pK*= 1+LB.sin(qK)*XK;}rK=pK.toInt();if(rK<8){rK=8;}if(ZK==0){GK+= HK;if(GK<0){GK=0.0;}else if(GK>.5){GK=.5;}}if( ++gK>aK){gK=0.0;switch ( ++tK){case 1:aK=zJ;break;case 2:aK=AK;break;}}switch (tK){case 0:hK=gK*bK;break;case 1:hK=1+(1-gK*cK)*2*WK;break;case 2:hK=1-gK*dK;break;case 3:hK=0.0;fK=true;break;}if(SK){UK+= TK;vK=UK.toInt();if(vK<0){vK=-vK;}else if(vK>1023){vK=1023;}}if(KK&&MK!=0.0){LK*= MK;if(LK<.00001){LK=.00001;}else if(LK>.1){LK=.1;}}oK=0.0;for(var j=0;j<8;j++ ){sK++ ;if(sK>=rK){sK%= rK;if(ZK==3){for(var i=yK.length-1;i>-1;i-- ){yK[i]=n.nextDouble()*2-1;}}}switch (ZK){case 0:nK=((sK/rK)<GK)?.5:-.5;break;case 1:nK=1-(sK/rK)*2;break;case 2:mK=sK/rK;mK=mK>.5?(mK-1)*6.28318531:mK*6.28318531;nK=mK<0?1.27323954*mK+.405284735*mK*mK:1.27323954*mK-.405284735*mK*mK;nK=nK<0?.225*(nK*-nK-nK)+nK:.225*(nK*nK-nK)+nK;break;case 3:nK=yK[(sK*32/rK).abs().toInt()];break;}if(KK){kK=lK;NK*= OK;if(NK<0){NK=0;}else if(NK>.1){NK=.1;}if(PK){jK+= (nK-lK)*NK;jK*= eK;}else{lK=nK;jK=0.0;}lK+= jK;iK+= lK-kK;iK*= 1-LK;nK=iK;}if(SK){xK[uK%1024]=nK;nK+= xK[(uK-vK+1024)%1024];uK++ ;}oK+= nK;}oK*= .125*hK*QK;oK=oK>=1?1.0:oK<=-1?-1.0:oK;q[h]=oK;}return false;}static  lF( j, n){var i=new kF(new PE.MH(n));var h=i.YG();var g=j.createBuffer(2,h,44100);assert(h<=g.length);i.XG(g.getChannelData(0),h);return g;}}//@ sourceMappingURL=out.dart.map
